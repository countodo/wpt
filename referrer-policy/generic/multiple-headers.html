<!DOCTYPE html>
<html>
  <head>
    <title>Referrer Policy: multiple Referrer-Policy headers are allowed</title>
    <script src="/resources/testharness.js"></script>
    <script src="/resources/testharnessreport.js"></script>

    <script src="/referrer-policy/generic/common.js"></script>
    <script src="/referrer-policy/generic/referrer-policy-test-case.js"></script>
  </head>
  <body>
    <h1>Referrer Policy: multiple Referrer-Policy headers are allowed</h1>
    <p></p>

    <pre id="received_message">Running...</pre>

    <script>
      var test = async_test("Image uses the last recognized Referrer-Policy header");
      var urlPath = '/referrer-policy/generic/subresource/image.py?cache_destroyer=' + (new Date()).getTime();
      var url = location.protocol + "//www1." + location.hostname + ":" + location.port +
                urlPath;
      requestViaImageForReferrerPolicy(url).then(test.step_func(function(message) {
        assert_equals(message.referrer, document.location.origin + "/");
        test.done();
      }), null, 'no-referrer');
    </script>

    <div id="log"></div>
  </body>
</html>
